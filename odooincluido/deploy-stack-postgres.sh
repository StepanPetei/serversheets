#!/bin/bash

# ==================================
# CONFIGURACIÃ“N INICIAL
# ==================================
WORDPRESS_DOMAIN="tu-dominio.com"
PHPMYADMIN_DOMAIN="admin.tu-dominio.com"
ODOO_DOMAIN="erp.tu-dominio.com"
EMAIL="tu-email@tudominio.com"

# ==================================
# CREAR ESTRUCTURA DE CARPETAS
# ==================================
mkdir -p wordpress-stack/nginx/conf.d
mkdir -p wordpress-stack/nginx/html

cd wordpress-stack || exit 1

# ==================================
# CREAR DOCKER-COMPOSE.YML
# ==================================
cat <<EOF > docker-compose.yml
version: '3.9'

services:
  wordpress:
      image: wordpress:latest
          container_name: wordpress
              restart: always
                  environment:
                        WORDPRESS_DB_HOST: mysql:3306
                              WORDPRESS_DB_NAME: wordpress
                                    WORDPRESS_DB_USER: wpuser
                                          WORDPRESS_DB_PASSWORD: wppassword
                                              networks:
                                                    - internal
                                                        volumes:
                                                              - wordpress_data:/var/www/html

                                                                odoo:
                                                                    image: odoo:17
                                                                        container_name: odoo
                                                                            restart: always
                                                                                environment:
                                                                                      - HOST=postgres
                                                                                            - USER=odoo
                                                                                                  - PASSWORD=odoopassword
                                                                                                      depends_on:
                                                                                                            - postgres
                                                                                                                networks:
                                                                                                                      - internal
                                                                                                                          ports:
                                                                                                                                - "8069:8069"
                                                                                                                                    volumes:
                                                                                                                                          - odoo_data:/var/lib/odoo

                                                                                                                                            mysql:
                                                                                                                                                image: mysql:8.0
                                                                                                                                                    container_name: mysql
                                                                                                                                                        restart: always
                                                                                                                                                            environment:
                                                                                                                                                                  MYSQL_ROOT_PASSWORD: rootpassword
                                                                                                                                                                        MYSQL_DATABASE: wordpress
                                                                                                                                                                              MYSQL_USER: wpuser
                                                                                                                                                                                    MYSQL_PASSWORD: wppassword
                                                                                                                                                                                        command: --default-authentication-plugin=mysql_native_password
                                                                                                                                                                                            networks:
                                                                                                                                                                                                  - internal
                                                                                                                                                                                                      volumes:
                                                                                                                                                                                                            - mysql_data:/var/lib/mysql

                                                                                                                                                                                                              postgres:
                                                                                                                                                                                                                  image: postgres:15
                                                                                                                                                                                                                      container_name: postgres
                                                                                                                                                                                                                          restart: always
                                                                                                                                                                                                                              environment:
                                                                                                                                                                                                                                    POSTGRES_DB=postgres
                                                                                                                                                                                                                                          POSTGRES_USER=odoo
                                                                                                                                                                                                                                                POSTGRES_PASSWORD=odoopassword
                                                                                                                                                                                                                                                    networks:
                                                                                                                                                                                                                                                          - internal
                                                                                                                                                                                                                                                              volumes:
                                                                                                                                                                                                                                                                    - postgres_data:/var/lib/postgresql/data

                                                                                                                                                                                                                                                                      phpmyadmin:
                                                                                                                                                                                                                                                                          image: phpmyadmin/phpmyadmin
                                                                                                                                                                                                                                                                              container_name: phpmyadmin
                                                                                                                                                                                                                                                                                  restart: always
                                                                                                                                                                                                                                                                                      depends_on:
                                                                                                                                                                                                                                                                                            - mysql
                                                                                                                                                                                                                                                                                                environment:
                                                                                                                                                                                                                                                                                                      PMA_HOST: mysql
                                                                                                                                                                                                                                                                                                            PMA_USER: root
                                                                                                                                                                                                                                                                                                                  PMA_PASSWORD: rootpassword
                                                                                                                                                                                                                                                                                                                      networks:
                                                                                                                                                                                                                                                                                                                            - internal

                                                                                                                                                                                                                                                                                                                              nginx:
                                                                                                                                                                                                                                                                                                                                  image: nginx:latest
                                                                                                                                                                                                                                                                                                                                      container_name: nginx
                                                                                                                                                                                                                                                                                                                                          restart: always
                                                                                                                                                                                                                                                                                                                                              ports:
                                                                                                                                                                                                                                                                                                                                                    - "80:80"
                                                                                                                                                                                                                                                                                                                                                          - "443:443"
                                                                                                                                                                                                                                                                                                                                                              volumes:
                                                                                                                                                                                                                                                                                                                                                                    - ./nginx/conf.d:/etc/nginx/conf.d
                                                                                                                                                                                                                                                                                                                                                                          - certbot-etc:/etc/letsencrypt
                                                                                                                                                                                                                                                                                                                                                                                - certbot-var:/var/lib/letsencrypt
                                                                                                                                                                                                                                                                                                                                                                                      - ./nginx/html:/usr/share/nginx/html
                                                                                                                                                                                                                                                                                                                                                                                          depends_on:
                                                                                                                                                                                                                                                                                                                                                                                                - wordpress
                                                                                                                                                                                                                                                                                                                                                                                                      - phpmyadmin
                                                                                                                                                                                                                                                                                                                                                                                                            - odoo
                                                                                                                                                                                                                                                                                                                                                                                                                networks:
                                                                                                                                                                                                                                                                                                                                                                                                                      - internal
                                                                                                                                                                                                                                                                                                                                                                                                                            - external

                                                                                                                                                                                                                                                                                                                                                                                                                              certbot:
                                                                                                                                                                                                                                                                                                                                                                                                                                  image: certbot/certbot
                                                                                                                                                                                                                                                                                                                                                                                                                                      container_name: certbot
                                                                                                                                                                                                                                                                                                                                                                                                                                          volumes:
                                                                                                                                                                                                                                                                                                                                                                                                                                                - certbot-etc:/etc/letsencrypt
                                                                                                                                                                                                                                                                                                                                                                                                                                                      - certbot-var:/var/lib/letsencrypt
                                                                                                                                                                                                                                                                                                                                                                                                                                                            - ./nginx/html:/usr/share/nginx/html
                                                                                                                                                                                                                                                                                                                                                                                                                                                                entrypoint: "/bin/sh -c 'trap exit TERM; while :; do sleep 6h & wait $${!}; certbot renew; done'"
                                                                                                                                                                                                                                                                                                                                                                                                                                                                    networks:
                                                                                                                                                                                                                                                                                                                                                                                                                                                                          - external

                                                                                                                                                                                                                                                                                                                                                                                                                                                                          volumes:
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            wordpress_data:
                                                                                                                                                                                                                                                                                                                                                                                                                                                                              mysql_data:
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                postgres_data:
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  odoo_data:
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    certbot-etc:
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      certbot-var:

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      networks:
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        internal:
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          external:
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          EOF

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          # ==================================
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          # CREAR CONFIGURACIONES NGINX
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          # ==================================

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          # WordPress
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          cat <<EOF > nginx/conf.d/wordpress.conf
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          server {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              listen 80;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  server_name $WORDPRESS_DOMAIN www.$WORDPRESS_DOMAIN;

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      location / {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              proxy_pass http://wordpress:80;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      proxy_set_header Host \$host;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              proxy_set_header X-Real-IP \$remote_addr;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  }

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      location /.well-known/acme-challenge/ {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              root /usr/share/nginx/html;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  EOF

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  # phpMyAdmin
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  cat <<EOF > nginx/conf.d/phpmyadmin.conf
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  server {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      listen 80;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          server_name $PHPMYADMIN_DOMAIN;

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              location / {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      proxy_pass http://phpmyadmin:80;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              proxy_set_header Host \$host;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      proxy_set_header X-Real-IP \$remote_addr;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          }

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              location /.well-known/acme-challenge/ {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      root /usr/share/nginx/html;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          EOF

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          # Odoo
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          cat <<EOF > nginx/conf.d/odoo.conf
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          server {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              listen 80;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  server_name $ODOO_DOMAIN;

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      location / {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              proxy_pass http://odoo:8069;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      proxy_set_header Host \$host;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              proxy_set_header X-Real-IP \$remote_addr;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  }

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      location /.well-known/acme-challenge/ {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              root /usr/share/nginx/html;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  EOF

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  # ==================================
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  # LEVANTAR LOS CONTENEDORES
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  # ==================================
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  docker-compose up -d nginx wordpress phpmyadmin odoo mysql postgres

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  echo "Esperando 15 segundos para que arranquen los servicios..."
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  sleep 15

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  # ==================================
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  # CERTIFICADOS SSL CON CERTBOT
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  # ==================================
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  echo "Generando certificados SSL para WordPress..."
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  docker-compose run --rm certbot certonly --webroot \
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    --webroot-path=/usr/share/nginx/html \
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      --email $EMAIL --agree-tos --no-eff-email \
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        -d $WORDPRESS_DOMAIN -d www.$WORDPRESS_DOMAIN

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        echo "Generando certificados SSL para phpMyAdmin..."
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        docker-compose run --rm certbot certonly --webroot \
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          --webroot-path=/usr/share/nginx/html \
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            --email $EMAIL --agree-tos --no-eff-email \
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              -d $PHPMYADMIN_DOMAIN

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              echo "Generando certificados SSL para Odoo..."
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              docker-compose run --rm certbot certonly --webroot \
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                --webroot-path=/usr/share/nginx/html \
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  --email $EMAIL --agree-tos --no-eff-email \
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    -d $ODOO_DOMAIN

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    # ==================================
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    # ACTUALIZAR CONFIGS NGINX PARA HTTPS
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    # ==================================

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    # WordPress HTTPS
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    cat <<EOF > nginx/conf.d/wordpress.conf
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    server {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        listen 80;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            server_name $WORDPRESS_DOMAIN www.$WORDPRESS_DOMAIN;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                return 301 https://\$host\$request_uri;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                }

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                server {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    listen 443 ssl;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        server_name $WORDPRESS_DOMAIN www.$WORDPRESS_DOMAIN;

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            ssl_certificate /etc/letsencrypt/live/$WORDPRESS_DOMAIN/fullchain.pem;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ssl_certificate_key /etc/letsencrypt/live/$WORDPRESS_DOMAIN/privkey.pem;

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    location / {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            proxy_pass http://wordpress:80;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    proxy_set_header Host \$host;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            proxy_set_header X-Real-IP \$remote_addr;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                EOF

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                # phpMyAdmin HTTPS
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                cat <<EOF > nginx/conf.d/phpmyadmin.conf
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                server {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    listen 80;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        server_name $PHPMYADMIN_DOMAIN;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            return 301 https://\$host\$request_uri;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            }

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            server {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                listen 443 ssl;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    server_name $PHPMYADMIN_DOMAIN;

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        ssl_certificate /etc/letsencrypt/live/$PHPMYADMIN_DOMAIN/fullchain.pem;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            ssl_certificate_key /etc/letsencrypt/live/$PHPMYADMIN_DOMAIN/privkey.pem;

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                location / {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        proxy_pass http://phpmyadmin:80;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                proxy_set_header Host \$host;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        proxy_set_header X-Real-IP \$remote_addr;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            EOF

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            # Odoo HTTPS
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            cat <<EOF > nginx/conf.d/odoo.conf
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            server {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                listen 80;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    server_name $ODOO_DOMAIN;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        return 301 https://\$host\$request_uri;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        }

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        server {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            listen 443 ssl;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                server_name $ODOO_DOMAIN;

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ssl_certificate /etc/letsencrypt/live/$ODOO_DOMAIN/fullchain.pem;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        ssl_certificate_key /etc/letsencrypt/live/$ODOO_DOMAIN/privkey.pem;

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            location / {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    proxy_pass http://odoo:8069;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            proxy_set_header Host \$host;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    proxy_set_header X-Real-IP \$remote_addr;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        EOF

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        # ==================================
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        # REINICIAR NGINX PARA ACTIVAR HTTPS
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        # ==================================
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        docker-compose restart nginx

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        # ==================================
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        # FIN DEL SCRIPT
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        # ==================================
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        echo "=============================================="
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        echo " Â¡DEPLOY COMPLETO!"
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        echo " WordPress: https://$WORDPRESS_DOMAIN"
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        echo " phpMyAdmin: https://$PHPMYADMIN_DOMAIN"
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        echo " Odoo: https://$ODOO_DOMAIN"
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        echo "=============================================="